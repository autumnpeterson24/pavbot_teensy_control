HEY FIYA! Here are some of your next steps:

What your side currently looks like now: 

1. cmd_vel_to_wheels.cpp ~the skeleton we have right now

2. teensy_serial_transport (not yet written it is just teensy_control_stub.cpp right now)
    * serial communication

TASK 1: =============
Replace Stub with Real Serial Transport (Highest Priority)

Goals:
1. Replace teensy_transport_stub with teensy_transport_serial
2. Preserve the /teensy/wheels interface exactly

Tasks:
1. Open a serial port (/dev/ttyACM*)
2. Serialize WheelCmd.left/right
3. Transmit at fixed rate (>= 20 Hz)
4. Implement reconnect-on-reset
E5. nforce watchdog timeout -> neutral (Jetson side)

Deliverables
1. teensy_transport_serial.cpp
2. PROTOCOL.md describing the on-wire format
3. Parameterized port, baud rate, timeout

Success Criteria
1. Transport state reports ACTIVE when commands arrive
2. Motors stop within timeout when /cmd_vel is killed

TASK 2: =================
Teensy Firmware Integration

Goals:
1. Teensy accepts wheel commands and drives motor outputs safely
2. Independent watchdog on the MCU

Tasks:
1. Parse incoming wheel commands
2. Map normalized [-1, 1] â†’ motor driver input (PWM/DIR or DAC)
3. Enforce local timeout -> neutral
4. Add optional heartbeat / ACK

Success Criteria
1. Robot stops if Jetson cable is unplugged
2. Robot stops if Teensy firmware crashes/restarts

Task 3: ===================
Safety & Integration Hardening

Goals:
1. Ensure the drivetrain cannot move unless all safety conditions are satisfied

Tasks:
1. Subscribe to /safety/estop
2. Force neutral on estop assertion
3. Add fault reporting (overcurrent, driver fault pins)

Deliverables
1. Updated transport logic
2. Clear safety state transitions

Success Criteria
1. Estop always overrides motion
2. No unexpected movement during startup/shutdown

RESOURCES:
Ros resources:
https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Writing-A-Simple-Cpp-Publisher-And-Subscriber.html
https://docs.ros.org/en/humble/Tutorials/Beginner-Client-Libraries/Using-Parameters-In-A-Class-CPP.html

Serial library resource:
https://github.com/wjwwood/serial 

Realtime serial data and how to handle packets:
https://www.embeddedrelated.com/showarticle/113.php

================

